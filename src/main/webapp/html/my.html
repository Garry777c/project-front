<html>
<head>
    <title>RPG</title>
    <script src=https://code.jquery.com/jquery-3.6.0.min.js></script>
    <link href="/css/my.css" rel="stylesheet">
</head>
<body onload="addingRows()">
<h1>RPG admin panel</h1>

<label for="count_per_page">Count per page</label>
<select id="count_per_page" onchange="addingRows()"> //onchange - changing this every time when run method
    <option value="">3</option>
    <option value="">7</option>
    <option value="">10</option>
    <option value="">15</option>
    <option value="">20</option>

</select>


<table id="myTable">
    <tr>
        <th>#</th><th>Name</th><th>Title</th> <th>Race</th> <th>Profession</th> <th>Level</th> <th>Birthday</th><th>Banned</th>
    </tr>
</table>

<div id="pages">Pages</div>


<script>
    function addingRows(){ //request and adding accounts-players
        let playerUrl = "/rest/players";
        $.get(playerUrl, function (myData){
            $.each(myData, function (number, value){
                $('<tr>').html("<td>"
                    +value.id + "</td><td>"
                    +value.name + "</td><td>"
                    +value.title + "</td><td>"
                    +value.race + "</td><td>"
                    +value.profession + "</td><td>"
                    +value.level + "</td><td>"
                    +new Date(value.birthday).toLocaleDateString() + "</td><td>"
                    +value.banned + "</td>"
                ).appendTo("#myTable")
            })
        })


        let count = getCounts(); //run function
    }

    function getCounts (){ //request the total number of account
        let url = "/rest/players/count"
        let finalResult = 0;

        $.ajax({
            url: url,
            async: false,
            success: function (result){
                finalResult = parseInt(result)
            }
        })

        console.log(finalResult);
        return finalResult;
    }

</script>

</body>
</html>